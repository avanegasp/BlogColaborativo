<div class="container">
  <div class="row">
    <%= link_to "Ir a los posts", posts_path, class:"btn-primary btn-lg col-sm-offset-10"%>
    <h1><%=markdown(@post.title)%></h1>
    <% if @post.header_image.attached? %>
      <%=image_tag @post.header_image.variant(resize: "400x400")%>
      <p><%=@post.user.email%>,
      <%=time(@post)%></p>
      <p><%=markdown(@post.body) %></p>
      <div>
        <% @post.uploads.each do |upload|%>
          <% if upload.variable?%>
              <%=link_to image_tag(upload.variant(resize: "400x400")), upload%>
            <% elsif upload.previewable?%>
              <%=link_to image_tag(upload.preview(resize: "400x400")), rails_blob_path(upload, disposition: :attachment)%>
            <% elsif upload.image?%>
              <%=link_to image_tag(upload, width: 400), upload%>
            <% else %>
              <%=link_to upload.filename, rails_blob_path(upload, disposition: :attachment)%>
          <% end %>
        <%end%>
      </div>
    <% else %>
          <p><%=@post.user.email%>,
          <%=time(@post)%></p>
          <p><%=markdown(@post.body) %></p>
          <div>
            <% @post.uploads.each do |upload|%>
              <% if upload.variable?%>
                  <%=link_to image_tag(upload.variant(resize: "400x400")), upload%>
                <% elsif upload.previewable?%>
                  <%=link_to image_tag(upload.preview(resize: "400x400")), rails_blob_path(upload, disposition: :attachment)%>
                <% elsif upload.image?%>
                  <%=link_to image_tag(upload, width: 400), upload%>
                <% else %>
                  <%=link_to upload.filename, rails_blob_path(upload, disposition: :attachment)%>
              <% end %>
            <%end%>
          </div>
    <% end%>

    <%if @comment.errors.any?%>
      <div class="alert alert-danger">
        <ul>
          <% @comment.errors.full_messages.each do |error|%>
             <li><%= error %></li>
          <%end%>
         </ul>
      </div>
        <%else%>
        <div class="form-group">
          <%@post.comments.each do |comment| %>
            <br>
              <div class="comments">
                  <%= comment.user.email%>
                  <%=time(comment)%>
                <div class="comment-body">
                  <%= markdown(comment.body)%>
                </div>
              </div>
          <% end %>
        <%end%>
      </div>
      <%if user_signed_in? %>
        <%= render 'show'  %>
      <%end%>
  </div>
</div>
